webpackJsonp([19],{1036:function(l,n,t){"use strict";t(0),t(15),t(85),t(215);t.d(n,"a",function(){return o});var u=(this&&this.__decorate,this&&this.__metadata,this&&this.__awaiter||function(l,n,t,u){return new(t||(t=Promise))(function(e,o){function i(l){try{a(u.next(l))}catch(l){o(l)}}function r(l){try{a(u.throw(l))}catch(l){o(l)}}function a(l){l.done?e(l.value):new t(function(n){n(l.value)}).then(i,r)}a((u=u.apply(l,n||[])).next())})}),e=this&&this.__generator||function(l,n){function t(l){return function(n){return u([l,n])}}function u(t){if(e)throw new TypeError("Generator is already executing.");for(;r;)try{if(e=1,o&&(i=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(i=i.call(o,t[1])).done)return i;switch(o=0,i&&(t=[0,i.value]),t[0]){case 0:case 1:i=t;break;case 4:return r.label++,{value:t[1],done:!1};case 5:r.label++,o=t[1],t=[0];continue;case 7:t=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(6===t[0]||2===t[0])){r=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){r.label=t[1];break}if(6===t[0]&&r.label<i[1]){r.label=i[1],i=t;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(t);break}i[2]&&r.ops.pop(),r.trys.pop();continue}t=n.call(l,r)}catch(l){t=[6,l],o=0}finally{e=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var e,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return{next:t(0),throw:t(1),return:t(2)}},o=function(){function l(l,n,t,u,e){this.navCtrl=l,this.navParams=n,this.alertCtrl=t,this.barcodeScanner=u,this.bookService=e}return l.prototype.ngOnInit=function(){this.book=this.navParams.get("book"),this.type=this.navParams.get("type"),"addBook"===this.type?(this.showAddBtn=!0,this.showBorrowBtn=!1):this.book.QTY>0?(this.showAddBtn=!1,this.showBorrowBtn=!0):(this.showAddBtn=!1,this.showBorrowBtn=!1)},l.prototype.getAddQty=function(l){this.book.QTY=l},l.prototype.showError=function(l){this.alertCtrl.create({title:"错误",subTitle:l,buttons:["OK"]}).present()},l.prototype.showInfo=function(l){var n=this;this.alertCtrl.create({subTitle:l,buttons:[{text:"OK",handler:function(){n.navCtrl.pop()}}]}).present()},l.prototype.addBook=function(){return u(this,void 0,void 0,function(){var l,n,t,u;return e(this,function(e){switch(e.label){case 0:return e.trys.push([0,8,,9]),[4,this.bookService.addBook(this.book)];case 1:return e.sent(),"true"!==localStorage.getItem("batchAddBooks")?[3,6]:[4,this.bookService.scan()];case 2:return l=e.sent(),l.cancelled?[2]:l.cancelled||13!==l.text.length?[3,4]:[4,this.bookService.getBookInfoFromDouban(l.text)];case 3:return n=e.sent(),6e3===n.json().code?this.showError("豆瓣上找不到该书籍的信息，请人工输入."):(t=this.bookService.transformBookInfo(n.json()),this.book=t),[3,5];case 4:this.showError("你所扫描的并不是有效的ISBN码"),e.label=5;case 5:return[3,7];case 6:this.showInfo("录入成功"),e.label=7;case 7:return[3,9];case 8:return u=e.sent(),this.showError("添加图书错误"),[3,9];case 9:return[2]}})})},l.prototype.borrowBook=function(l){return u(this,void 0,void 0,function(){var n;return e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.bookService.borrowBook(l)];case 1:return t.sent(),this.showInfo("预约成功"),[3,3];case 2:return n=t.sent(),this.showError("预约图书失败"),[3,3];case 3:return[2]}})})},l}()},1177:function(l,n,t){"use strict";t(0),t(15),t(1036),t(970);t.d(n,"a",function(){return u});var u=(this&&this.__decorate,function(){function l(){}return l}())},1178:function(l,n,t){"use strict";function u(l){return r["ɵvid"](0,[(l()(),r["ɵeld"](0,null,null,2,"button",[["ion-button",""]],null,[[null,"click"]],function(l,n,t){var u=!0,e=l.component;if("click"===n){u=e.borrowBook(e.book.ISBN13)!==!1&&u}return u},a.a,a.b)),r["ɵdid"](1097728,[[1,4]],0,d.a,[[8,""],s.c,r.ElementRef,r.Renderer],null,null),(l()(),r["ɵted"](0,["预约"]))],null,null)}function e(l){return r["ɵvid"](0,[(l()(),r["ɵeld"](0,null,null,2,"button",[["ion-button",""]],null,[[null,"click"]],function(l,n,t){var u=!0,e=l.component;if("click"===n){u=e.addBook()!==!1&&u}return u},a.a,a.b)),r["ɵdid"](1097728,[[1,4]],0,d.a,[[8,""],s.c,r.ElementRef,r.Renderer],null,null),(l()(),r["ɵted"](0,["录入"]))],null,null)}function o(l){return r["ɵvid"](0,[(l()(),r["ɵeld"](0,null,null,21,"ion-header",[],null,null,null,null,null)),r["ɵdid"](16384,null,0,c.a,[s.c,r.ElementRef,r.Renderer,[2,h.a]],null,null),(l()(),r["ɵted"](null,["\n  "])),(l()(),r["ɵeld"](0,null,null,17,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,f.a,f.b)),r["ɵdid"](49152,null,0,p.a,[_.a,[2,h.a],[2,b.a],s.c,r.ElementRef,r.Renderer],null,null),(l()(),r["ɵted"](3,["\n    "])),(l()(),r["ɵeld"](0,null,3,2,"ion-title",[],null,null,null,k.a,k.b)),r["ɵdid"](49152,null,0,v.a,[s.c,r.ElementRef,r.Renderer,[2,w.a],[2,p.a]],null,null),(l()(),r["ɵted"](0,["图书详情"])),(l()(),r["ɵted"](3,["\n    "])),(l()(),r["ɵeld"](0,null,2,9,"ion-buttons",[["end",""]],null,null,null,null,null)),r["ɵdid"](16384,null,1,g.a,[s.c,r.ElementRef,r.Renderer,[2,w.a],[2,p.a]],null,null),r["ɵqud"](603979776,1,{_buttons:1}),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵand"](16777216,null,null,1,null,u)),r["ɵdid"](16384,null,0,m.k,[r.ViewContainerRef,r.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵand"](16777216,null,null,1,null,e)),r["ɵdid"](16384,null,0,m.k,[r.ViewContainerRef,r.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),r["ɵted"](null,["\n    "])),(l()(),r["ɵted"](3,["\n  "])),(l()(),r["ɵted"](null,["\n"])),(l()(),r["ɵted"](null,["\n"])),(l()(),r["ɵeld"](0,null,null,47,"ion-content",[],[[2,"statusbar-padding",null]],null,null,y.a,y.b)),r["ɵdid"](4374528,null,0,B.a,[s.c,I.b,A.a,r.ElementRef,r.Renderer,_.a,C.a,r.NgZone,[2,h.a],[2,b.a]],null,null),(l()(),r["ɵted"](1,["\n  "])),(l()(),r["ɵeld"](0,null,1,43,"div",[["class","main-wrapper"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n    "])),(l()(),r["ɵeld"](0,null,null,5,"div",[["class","book-list-wrapper"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵeld"](0,null,null,2,"sg-book-list",[],null,[[null,"onInputChange"]],function(l,n,t){var u=!0,e=l.component;if("onInputChange"===n){u=e.getAddQty(t)!==!1&&u}return u},E.a,E.b)),r["ɵdid"](49152,null,0,D.a,[],{books:[0,"books"],showAddBookInput:[1,"showAddBookInput"]},{onInputChange:"onInputChange"}),r["ɵpad"](1),(l()(),r["ɵted"](null,["\n    "])),(l()(),r["ɵted"](null,["\n    "])),(l()(),r["ɵeld"](0,null,null,32,"div",[["class","book-detail-wrapper"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵeld"](0,null,null,7,"div",[["class","book-intro"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n        "])),(l()(),r["ɵeld"](0,null,null,1,"span",[["class","book-title"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["内容推荐"])),(l()(),r["ɵted"](null,["\n        "])),(l()(),r["ɵeld"](0,null,null,1,"div",[["class","book-msg"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["",""])),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵeld"](0,null,null,0,"div",[["class","space-line-30"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵeld"](0,null,null,7,"div",[["class","book-intro"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n        "])),(l()(),r["ɵeld"](0,null,null,1,"span",[["class","book-title"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["作者简介"])),(l()(),r["ɵted"](null,["\n        "])),(l()(),r["ɵeld"](0,null,null,1,"div",[["class","book-msg"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["",""])),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵeld"](0,null,null,0,"div",[["class","space-line-30"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵeld"](0,null,null,7,"div",[["class","book-intro"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["\n        "])),(l()(),r["ɵeld"](0,null,null,1,"span",[["class","book-title"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["目录"])),(l()(),r["ɵted"](null,["\n        "])),(l()(),r["ɵeld"](0,null,null,1,"pre",[["class","book-catalog"]],null,null,null,null,null)),(l()(),r["ɵted"](null,["",""])),(l()(),r["ɵted"](null,["\n      "])),(l()(),r["ɵted"](null,["\n    "])),(l()(),r["ɵted"](null,["\n    "])),(l()(),r["ɵted"](null,["\n  "])),(l()(),r["ɵted"](1,["\n"])),(l()(),r["ɵted"](null,["\n"]))],function(l,n){var t=n.component;l(n,15,0,t.showBorrowBtn),l(n,18,0,t.showAddBtn),l(n,31,0,l(n,32,0,t.book),t.showAddBtn)},function(l,n){var t=n.component;l(n,3,0,r["ɵnov"](n,4)._hidden,r["ɵnov"](n,4)._sbPadding),l(n,23,0,r["ɵnov"](n,24).statusbarPadding),l(n,43,0,t.book.SUMMARY),l(n,54,0,t.book.AUTHOR_INTRO),l(n,65,0,t.book.CATALOG)})}function i(l){return r["ɵvid"](0,[(l()(),r["ɵeld"](0,null,null,1,"sg-book-detail",[],null,null,null,o,L)),r["ɵdid"](114688,null,0,R.a,[b.a,M.a,T.a,P.a,O.a],null,null)],function(l,n){l(n,1,0)},null)}var r=t(0),a=t(34),d=t(23),s=t(3),c=t(38),h=t(6),f=t(44),p=t(25),_=t(8),b=t(16),k=t(47),v=t(39),w=t(29),g=t(84),m=t(11),y=t(40),B=t(20),I=t(4),A=t(9),C=t(18),R=t(1036),E=t(983),D=t(965),M=t(17),T=t(86),P=t(85),O=t(215);t.d(n,"a",function(){return N});var x=[],L=r["ɵcrt"]({encapsulation:2,styles:x,data:{}}),N=r["ɵccf"]("sg-book-detail",R.a,i,{},{},[])},814:function(l,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var u=t(0),e=t(1177),o=t(11),i=t(19),r=t(210),a=t(970),d=t(447),s=t(448),c=t(449),h=t(450),f=t(451),p=t(452),_=t(453),b=t(454),k=t(455),v=t(1178),w=t(1036),g=t(72);t.d(n,"BookDetailComponentModuleNgFactory",function(){return B});var m=this&&this.__extends||function(){var l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,n){l.__proto__=n}||function(l,n){for(var t in n)n.hasOwnProperty(t)&&(l[t]=n[t])};return function(n,t){function u(){this.constructor=n}l(n,t),n.prototype=null===t?Object.create(t):(u.prototype=t.prototype,new u)}}(),y=function(l){function n(n){return l.call(this,n,[d.a,s.a,c.a,h.a,f.a,p.a,_.a,b.a,k.a,v.a],[])||this}return m(n,l),Object.defineProperty(n.prototype,"_NgLocalization_8",{get:function(){return null==this.__NgLocalization_8&&(this.__NgLocalization_8=new o.a(this.parent.get(u.LOCALE_ID))),this.__NgLocalization_8},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_ɵi_9",{get:function(){return null==this.__ɵi_9&&(this.__ɵi_9=new i.a),this.__ɵi_9},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_FormBuilder_10",{get:function(){return null==this.__FormBuilder_10&&(this.__FormBuilder_10=new i.b),this.__FormBuilder_10},enumerable:!0,configurable:!0}),n.prototype.createInternal=function(){return this._CommonModule_0=new o.d,this._ɵba_1=new i.c,this._FormsModule_2=new i.d,this._ReactiveFormsModule_3=new i.e,this._IonicModule_4=new r.b,this._BookListComponentModule_5=new a.a,this._IonicPageModule_6=new r.c,this._BookDetailComponentModule_7=new e.a,this._LAZY_LOADED_TOKEN_11=w.a,this._BookDetailComponentModule_7},n.prototype.getInternal=function(l,n){return l===o.d?this._CommonModule_0:l===i.c?this._ɵba_1:l===i.d?this._FormsModule_2:l===i.e?this._ReactiveFormsModule_3:l===r.b?this._IonicModule_4:l===a.a?this._BookListComponentModule_5:l===r.c?this._IonicPageModule_6:l===e.a?this._BookDetailComponentModule_7:l===o.e?this._NgLocalization_8:l===i.a?this._ɵi_9:l===i.b?this._FormBuilder_10:l===g.d?this._LAZY_LOADED_TOKEN_11:n},n.prototype.destroyInternal=function(){},n}(u["ɵNgModuleInjector"]),B=new u.NgModuleFactory(y,e.a)},965:function(l,n,t){"use strict";var u=t(0);t.d(n,"a",function(){return e});var e=(this&&this.__decorate,this&&this.__metadata,function(){function l(){this.showAddBookInput=!1,this.showPayBackDate=!1,this.showActualBackDate=!1,this.onClick=new u.EventEmitter,this.onInputChange=new u.EventEmitter,this.addBookQty=1,this.addBookQty=1}return l.prototype.ionViewDidLoad=function(){console.log("book list did load")},l.prototype.ionViewWillEnter=function(){console.log("book list will enter"),this.addBookQty=1},l.prototype.goToDetailPage=function(l){this.onClick.emit(l)},l.prototype.inputChange=function(l){this.onInputChange.emit(l.target.value)},l.prototype.trackByBooks=function(l,n){return n.ISBN13},l}())},970:function(l,n,t){"use strict";t(0),t(15),t(965);t.d(n,"a",function(){return u});var u=(this&&this.__decorate,function(){function l(){}return l}())},983:function(l,n,t){"use strict";function u(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,null,null,1,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["可借数量: ",""]))],null,function(l,n){l(n,1,0,n.parent.context.$implicit.QTY)})}function e(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,null,null,3,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["\n          录入数量:"])),(l()(),s["ɵeld"](0,null,null,0,"input",[["style","text-indent: 5px;"],["type","text"],["value","1"]],null,[[null,"input"]],function(l,n,t){var u=!0,e=l.component;if("input"===n){u=e.inputChange(t)!==!1&&u}return u},null,null)),(l()(),s["ɵted"](null,["\n        "]))],null,null)}function o(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,null,null,2,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["借书期限至: ",""])),s["ɵppd"](2)],null,function(l,n){l(n,1,0,s["ɵunv"](n,1,0,l(n,2,0,s["ɵnov"](n.parent.parent,0),n.parent.context.$implicit.SHOULD_PAYBACK_DATE,"y-MM-dd")))})}function i(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,null,null,2,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["归还时间: ",""])),s["ɵppd"](2)],null,function(l,n){l(n,1,0,s["ɵunv"](n,1,0,l(n,2,0,s["ɵnov"](n.parent.parent,0),n.parent.context.$implicit.ACTUAL_PAYBACK_DATE,"y-MM-dd")))})}function r(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,null,null,36,"button",[["class","book-list"]],null,[[null,"click"]],function(l,n,t){var u=!0,e=l.component;if("click"===n){u=e.goToDetailPage(l.context.$implicit)!==!1&&u}return u},null,null)),(l()(),s["ɵted"](null,["\n    "])),(l()(),s["ɵeld"](0,null,null,3,"div",[["class","book-image"]],null,null,null,null,null)),(l()(),s["ɵted"](null,["\n      "])),(l()(),s["ɵeld"](0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(l()(),s["ɵted"](null,["\n    "])),(l()(),s["ɵted"](null,["\n    "])),(l()(),s["ɵeld"](0,null,null,28,"div",[["class","book-info"]],null,null,null,null,null)),(l()(),s["ɵted"](null,["\n      "])),(l()(),s["ɵeld"](0,null,null,25,"div",[["class","book-info-style"]],null,null,null,null,null)),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵeld"](0,null,null,1,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["书名: ",""])),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵeld"](0,null,null,1,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["作者: ",""])),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵeld"](0,null,null,1,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["价格: ",""])),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵeld"](0,null,null,1,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["出版信息: ",""])),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵand"](16777216,null,null,1,null,u)),s["ɵdid"](16384,null,0,c.k,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵand"](16777216,null,null,1,null,e)),s["ɵdid"](16384,null,0,c.k,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵand"](16777216,null,null,1,null,o)),s["ɵdid"](16384,null,0,c.k,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](null,["\n        "])),(l()(),s["ɵand"](16777216,null,null,1,null,i)),s["ɵdid"](16384,null,0,c.k,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](null,["\n      "])),(l()(),s["ɵted"](null,["\n    "])),(l()(),s["ɵted"](null,["\n  "]))],function(l,n){var t=n.component;l(n,24,0,!t.showAddBookInput&&!t.showPayBackDate&&!t.showActualBackDate),l(n,27,0,t.showAddBookInput),l(n,30,0,t.showPayBackDate),l(n,33,0,t.showActualBackDate)},function(l,n){l(n,4,0,n.context.$implicit.IMAGE),l(n,12,0,n.context.$implicit.TITLE),l(n,15,0,n.context.$implicit.AUTHOR),l(n,18,0,n.context.$implicit.PRICE),l(n,21,0,n.context.$implicit.PUBLISHER)})}function a(l){return s["ɵvid"](0,[s["ɵpid"](0,c.m,[s.LOCALE_ID]),(l()(),s["ɵeld"](0,null,null,6,"div",[],null,null,null,null,null)),(l()(),s["ɵted"](null,["\n  "])),(l()(),s["ɵand"](16777216,null,null,1,null,r)),s["ɵdid"](802816,null,0,c.n,[s.ViewContainerRef,s.TemplateRef,s.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(l()(),s["ɵted"](null,["\n  "])),(l()(),s["ɵeld"](0,null,null,0,"div",[["class","line"]],null,null,null,null,null)),(l()(),s["ɵted"](null,["\n"])),(l()(),s["ɵted"](null,["\n"]))],function(l,n){l(n,4,0,n.component.books)},null)}function d(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,null,null,1,"sg-book-list",[],null,null,null,a,p)),s["ɵdid"](49152,null,0,h.a,[],null,null)],null,null)}var s=t(0),c=t(11),h=t(965);t.d(n,"b",function(){return p}),n.a=a;var f=[],p=s["ɵcrt"]({encapsulation:2,styles:f,data:{}});s["ɵccf"]("sg-book-list",h.a,d,{books:"books",showAddBookInput:"showAddBookInput",showPayBackDate:"showPayBackDate",showActualBackDate:"showActualBackDate"},{onClick:"onClick",onInputChange:"onInputChange"},[])}});
//# sourceMappingURL=D:\gary\github\MiApp\www\build\19.main.js.map